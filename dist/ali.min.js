/*!
 * --------------------------------------------------------------------------
 * Ali - Accessible Learning Interactions (
 * Copyright 2016 Jer Brand / Irresponsible Art
 * Licensed GPL (https://github.com/aut0poietic/ali/blob/master/LICENSE)
 * --------------------------------------------------------------------------
 */
"use strict";function _classCallCheck(a,b){if(!(a instanceof b))throw new TypeError("Cannot call a class as a function")}function _classCallCheck(a,b){if(!(a instanceof b))throw new TypeError("Cannot call a class as a function")}function _possibleConstructorReturn(a,b){if(!a)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!b||"object"!=typeof b&&"function"!=typeof b?a:b}function _inherits(a,b){if("function"!=typeof b&&null!==b)throw new TypeError("Super expression must either be null or a function, not "+typeof b);a.prototype=Object.create(b&&b.prototype,{constructor:{value:a,enumerable:!1,writable:!0,configurable:!0}}),b&&(Object.setPrototypeOf?Object.setPrototypeOf(a,b):a.__proto__=b)}jQuery(function(a){window.aliAutolInit!==!1&&a('[data-ali="accordion"]').accordion()});var ARIA=function(a){function b(a){return a=(""+a).toLowerCase().trim(),"role"!==a&&"tabindex"!==a?"aria-"+a:a}function c(a){return d.indexOf(a)>-1}var d=["role","tabindex","activedescendant","atomic","autocomplete","busy","checked","controls","describedby","disabled","dropeffect","expanded","flowto","grabbed","haspopup","hidden","invalid","label","labelledby","level","live","multiline","multiselectable","orientation","owns","posinset","pressed","readonly","relevant","required","selected","setsize","sort","valuemax","valuemin","valuenow","valuetext"];a.fn.aria=function(d,e){if("object"===a.type(d))for(var f in d)d.hasOwnProperty(f)&&this.aria(f,d[f]);else if(void 0!==d&&void 0!==e)this.each(function(){if(c(d)){var f=a(this),g=b(d);f.attr(g,e)}});else if(void 0!==d)return this.attr(b(d));return this}}(jQuery),_createClass=function(){function a(a,b){for(var c=0;c<b.length;c++){var d=b[c];d.enumerable=d.enumerable||!1,d.configurable=!0,"value"in d&&(d.writable=!0),Object.defineProperty(a,d.key,d)}}return function(b,c,d){return c&&a(b.prototype,c),d&&a(b,d),b}}(),aliInteraction=function(){function a(b,c){_classCallCheck(this,a),this.$el=$(b);var d=new Date;this._data={id:this.$el.attr("id"),start:d.getTime(),type:c,correct_responses:[],learner_response:[],result:null,latency:0,description:"Ali Interaction"}}return _createClass(a,[{key:"setDescription",value:function(a){this._data.description=a}},{key:"setResponses",value:function(a){}},{key:"setCorrectResponses",value:function(a){}},{key:"ready",value:function(){}},{key:"selectionChanged",value:function(a){}},{key:"itemComplete",value:function(a){arguments.length<=1||void 0===arguments[1]?"complete":arguments[1]}},{key:"complete",value:function(){arguments.length<=0||void 0===arguments[0]?"complete":arguments[0]}}]),a}(),_createClass=function(){function a(a,b){for(var c=0;c<b.length;c++){var d=b[c];d.enumerable=d.enumerable||!1,d.configurable=!0,"value"in d&&(d.writable=!0),Object.defineProperty(a,d.key,d)}}return function(b,c,d){return c&&a(b.prototype,c),d&&a(b,d),b}}(),aliAccordion=function(a){var b=".accordion-tab",c='.accordion-tab[aria-expanded="true"]',d=".accordion-panel",e=function(e){function f(e){_classCallCheck(this,f);var g=_possibleConstructorReturn(this,Object.getPrototypeOf(f).call(this,e));g.$el.aria({role:"tablist",multiselectable:"true"}),g.$tabs=a(b,g.$el);var h=a(c);return g.$tabs.each(function(b,c){var e=a(c),f=g._makeID(e),h=e.next(d);e.aria({role:"tab",tabindex:"0",expanded:"false",controls:f}).off("click.ali").on("click.ali",g.tab_onClick.bind(g)).off("keydown.ali").on("keydown.ali",g.tab_onKeyDown.bind(g)),h.aria({role:"tabpanel",tabindex:"-1",hidden:"true"}).attr({id:f,"data-height":g.getMeasuredHeight(h)}).off("keydown.ali").on("keydown.ali",g.panel_onKeyDown.bind(g))}),h.length>0?g.show(a(h[0])):g.getFirstTab().aria("tabindex",0),g.ready(),g}return _inherits(f,e),_createClass(f,[{key:"getMeasuredHeight",value:function(b){var c=a('<div id="ali-temp" aria-hidden="true" style="overflow:hidden;height:1px;width:100%;visibility: hidden"></div>').appendTo(this.$el),d=a('<dd class="accordion-panel"></dd>').html(b.html()).appendTo(c),e=d.height();return c.remove(),e}},{key:"getPanelFromTab",value:function(b){return a("#"+b.aria("controls"))}},{key:"getTabFromPanel",value:function(c){return a(b+'[aria-controls="'+c.attr("id")+'"]')}},{key:"hide",value:function(a){this.getPanelFromTab(a).aria({hidden:"true",tabindex:"-1"}).removeAttr("style"),a.aria("expanded","false")}},{key:"hideAll",value:function(){this.$tabs.each(function(b,c){this.hide(a(c))}.bind(this)),this.firstRun&&a("#panel-0").aria("hidden","true")}},{key:"show",value:function(a){var b=this.getPanelFromTab(a),c=parseInt(b.attr("data-height"));this.hideAll(),b.aria({hidden:"false",tabindex:"0"}),c>0&&b.css("max-height",c+"px"),a.aria({expanded:"true",selected:"true",tabindex:"0"}).focus()}},{key:"_nextTab",value:function(a){for(var c=a.next(),d=2*this.$tabs.length;c.length>0&&!c.is(b)&&0!=d--;)c=c.next();return c}},{key:"getNextTab",value:function(a){var b=this._nextTab(a);return 0===b.length?this.getFirstTab():b}},{key:"_previousTab",value:function(a){for(var c=a.prev(),d=2*this.$tabs.length;c.length>0&&!c.is(b)&&0!=d--;)c=c.prev();return c}},{key:"getPreviousTab",value:function(a){var b=this._previousTab(a);return 0===b.length?this.getLastTab():b}},{key:"getFirstTab",value:function(){return this.$tabs.first()}},{key:"getLastTab",value:function(){return this.$tabs.last()}},{key:"tab_onKeyDown",value:function(b){switch(b.which){case 13:case 32:b.preventDefault(),b.stopPropagation(),this.tab_onClick(b);break;case 37:case 38:b.preventDefault(),b.stopPropagation(),this.show(this.getPreviousTab(a(b.currentTarget)));break;case 39:case 40:b.preventDefault(),b.stopPropagation(),this.show(this.getNextTab(a(b.currentTarget)));break;case 35:b.preventDefault(),b.stopPropagation(),this.show(this.getLastTab());break;case 36:b.preventDefault(),b.stopPropagation(),this.show(this.getFirstTab())}}},{key:"tab_onClick",value:function(b){var c=a(b.target);"true"!==c.aria("expanded")?(this.hideAll(),this.show(c)):this.hide(c)}},{key:"panel_onKeyDown",value:function(b){if((b.ctrlKey||b.metaKey)&&b.currentTarget){var c,d=a(b.currentTarget);switch(b.which){case 38:b.preventDefault(),b.stopPropagation(),this.getTabFromPanel(d).focus();break;case 33:b.preventDefault(),b.stopPropagation(),c=this.getFirstTab(),"false"===c.aria("expanded")&&this.show(c),c.focus();break;case 40:b.preventDefault(),b.stopPropagation(),c=this.getLastTab(),"false"===c.aria("expanded")&&this.show(c),c.focus()}}}},{key:"_makeID",value:function(a){var b=a.text().replace(/[\W_]+/g,"").toLowerCase();return b.length>10&&(b=b.substring(0,10)),b}}],[{key:"_jQuery",value:function(){return this.each(function(){new f(this)})}}]),f}(aliInteraction);return a.fn.accordion=e._jQuery,a.fn.accordion.Constructor=e,a.fn.accordion.noConflict=function(){return a.fn.accordion=a.fn.accordion,e._jQuery},e}(jQuery);
//# sourceMappingURL=ali.min.js.map